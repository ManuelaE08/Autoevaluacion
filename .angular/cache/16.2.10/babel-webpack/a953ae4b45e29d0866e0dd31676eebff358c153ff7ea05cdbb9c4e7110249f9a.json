{"ast":null,"code":"export {};","map":{"version":3,"names":[],"sources":["C:\\Users\\manue\\OneDrive\\Documentos\\U\\2023.2\\Autoevaluacion\\src\\app\\components\\add-edit-labor\\add-edit-labor.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormBuilder, Validators, FormGroup } from '@angular/forms';\nimport { Labor } from 'src/app/interfaces/labor';\nimport { LaborService } from 'src/app/services/labor.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { TipoLabor } from \n\n@Component({\n  selector: 'app-add-edit-labor',\n  templateUrl: './add-edit-labor.component.html',\n  styleUrls: ['./add-edit-labor.component.css']\n})\nexport class AddEditLaborComponent implements OnInit{\n  tipoLabor: TipoLabor[] = [{\n    id: 1,\n    codigo: 'D',\n    descripcion: 'Docencia'\n  },{\n    id: 2,\n    codigo: 'TD',\n    descripcion: 'Trabajos Docencia'\n  },{\n    id: 3,\n    codigo: 'PI',\n    descripcion: 'Proyectos Investigación'\n  },{\n    id: 4,\n    codigo: 'TI',\n    descripcion: 'Trabajos Investigación'\n  },{\n    id: 5,\n    codigo: 'AD',\n    descripcion: 'Administración'\n  },{\n    id: 6,\n    codigo: 'AS',\n    descripcion: 'Asesoría'\n  },{\n    id: 7,\n    codigo: 'S',\n    descripcion: 'Servicios'\n  },{\n    id: 8,\n    codigo: 'E',\n    descripcion: 'Extensión'\n  },{\n    id: 9,\n    codigo: 'C',\n    descripcion: 'Capacitación'\n  },{\n    id: 10,\n    codigo: 'OS',\n    descripcion: 'Otros Servicios'\n  }];\n  formLabor: FormGroup;\n  id:number;\n  operacion: string = 'Agregar ';\n\n  constructor(private fb: FormBuilder,\n    private router :Router,\n    private aRouter: ActivatedRoute,\n    private _laborService: LaborService){\n    this.formLabor = this.fb.group({\n      tipLabId: [null, Validators.required],\n      nombreLab: ['', Validators.required],\n      horasLab: [null, Validators.required]\n    })\n    this.id = Number( aRouter.snapshot.paramMap.get('id'));\n    console.log(this.id);\n  }\n\n  ngOnInit(): void {\n    if(this.id != 0){\n      this.operacion= 'Editar ';\n      this.getLabor(this.id);\n    }\n  }\n\n  getLabor(id:number){\n    this._laborService.getLabor(id).subscribe((data: Labor) =>{\n      const lab: Labor = this.convertirLabor(data);\n      this.formLabor.setValue({\n        tipLabId: lab.idTipoLabor,\n        nombreLab: lab.nombre,\n        horasLab: lab.horas\n      })\n    })\n  }\n\n  addLabor(){\n    console.log(this.formLabor.value.tipLabId);\n    \n    const labor: Labor = {\n      idTipoLabor: this.formLabor.value.tipLabId,\n      nombre: this.formLabor.value.nombreLab,\n      horas: this.formLabor.value.horasLab\n    }\n    if(this.id !== 0){\n      //Editar \n      labor.id = this.id;\n      this._laborService.updateLabor(labor).subscribe(()=>{\n        console.log('labor update');\n        this.router.navigate(['/labor']);\n      })\n    }else{\n      //AGregar\n      this._laborService.saveLabor(labor).subscribe(() => {\n        console.log('labor agregada');\n        this.router.navigate(['/labor']);\n      })\n    }\n    \n  }\n\n  convertirLabor(labor: any): Labor{\n    let resultado: Labor =({\n      id: labor[0].atrLabID,\n      idTipoLabor: labor[0].atrTlID,\n      nombre: labor[0].atrLabNombre,\n      horas: labor[0].atrLabHoras\n    });\n    return resultado;\n  }\n}\n"],"mappings":""},"metadata":{},"sourceType":"module","externalDependencies":[]}